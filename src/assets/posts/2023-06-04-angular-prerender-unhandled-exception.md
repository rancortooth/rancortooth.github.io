---
date: "2023-06-04"
title: Angular Unhandled Exception Could Not Find Main Bundle
image: angular_fire.png
categories: Angular
tags: angular, troubleshooting
---
##### (image generated with stable_diffusion.openvino)

# An unhandled exception occurred: Could not find the main bundle: main.js

While working on this website I've encountered this error a few times while trying to prerender while using the @nguniversal/express-engine library
```bash
# i.e. When executing a command such as this
ng run MyWebsite:prerender
```

This unhelpful error typically indicates you have a subtle build error which prerendering is encoutering but not reporting on. In most cases, the website will appear to run fine while debugging yet this error still occurs.

# Some steps to take to get around this

## Try cleaning/rebuilding your way out of trouble

If you've made module changes or other significant changes, you may need to wipe out everything and rebuild from scratch. If any of these commands fails along the way, resolve the issue as it may be related to your prerendering woes.

```bash
# Get rid of any half-baked prerendered files
rm -rf dist/MyWebsite

# Clear Angular's cache
rm -rf .angular/cache

# Get rid of the package lock file
rm package-lock.json

# Get rid of the modules directory
rm -rf node_modules/

# Get rid of server.ts as it's generated by express-engine
rm server.ts
```

Ok! You've cleaned up. Time to rebuild.
```bash
# Install your modules
npm install

# Explicitly add back the express-engine and let it re-generate its stuff
ng add @nguniversal/express-engine

# Try prerendering again
ng run MyWebsite:prerender
```

## Don't ignore warnings

If your project runs during development even though it has a stack of warnings - don't ignore them! Resolve them.

## Don't run with dirty HTML

By "dirty" I mean if you're getting warnings about parts of your HTML being sanitized during the build then address these areas. For example, if content is dynamically placed into a table which may have dangerous content - or in my case, if  you're using ngx-markdown - address these issues.

## Backtrack a bit - what did you change?
If you were prerendering successfully before some recent changes, then backtrack. Do things such as commenting out those new routes you added in your app's routing module and try pre-rendering without them. The goal here is to isolate the change causing the problem and then study it more closely.